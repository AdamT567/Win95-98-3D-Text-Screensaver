<!doctype html>
<html>
<head>
<meta charset="utf-8" />
<title>Win98 3D Text â€“ Setup</title>
<meta name="viewport" content="width=device-width,initial-scale=1" />
<link rel="stylesheet" href="ui.css" />
</head>
<body>
<div class="ui">
  <h1>3D Text Setup</h1>

  <label><input type="radio" name="displayMode" value="text" checked> Text</label>
  <input id="text" value="Be Right Back" />

  <div class="row">
    <label>Surface:</label>
    <label><input type="radio" name="surface" value="solid" checked> Solid Color</label>
    <input type="color" id="color" value="#ffffff" />
    <label><input type="radio" name="surface" value="texture"> Textured</label>
    <input id="texture" placeholder="Texture URL" />
  </div>

  <div class="row">
    <label>Size</label>
    <input id="size" type="range" min="0.5" max="3" step="0.01" value="1.2">
  </div>

  <div class="row">
    <label>Speed</label>
    <input id="speed" type="range" min="0.1" max="3" step="0.01" value="1.0">
  </div>

  <div class="row">
    <label>Spin Style</label>
    <select id="spin">
      <option value="wobble">Wobble</option>
      <option value="spin">Spin</option>
      <option value="bounce">Bounce</option>
      <option value="random">Random</option>
    </select>
  </div>

  <div class="row">
    <label>Font</label>
    <input id="font" value="MS Sans Serif">
  </div>

  <div class="row">
    <button id="previewBtn">Preview</button>
    <button id="copyBtn">Copy OBS URL</button>
  </div>

  <input id="share" readonly />
</div>

<iframe id="preview" title="preview" style="position:fixed; inset:0; left:auto; right:12px; width:60%; height:60%; border:1px solid #222; background:#000"></iframe>

<script type="module">
const DEF = {
  displayMode:'text', text:'Be Right Back',
  surface:'solid', color:'#ffffff', texture:'',
  size:1.2, speed:1.0, spin:'wobble', font:'MS Sans Serif'
};
const KEY = 'w98_3dtext';

function readUI(){
  const v = {
    displayMode: document.querySelector('input[name=displayMode]:checked').value,
    text:        document.getElementById('text').value,
    surface:     document.querySelector('input[name=surface]:checked').value,
    color:       document.getElementById('color').value,
    texture:     document.getElementById('texture').value.trim(),
    size:        parseFloat(document.getElementById('size').value),
    speed:       parseFloat(document.getElementById('speed').value),
    spin:        document.getElementById('spin').value,
    font:        document.getElementById('font').value
  };
  localStorage.setItem(KEY, JSON.stringify(v));
  return v;
}
function writeUI(v){
  document.querySelector(`input[name=displayMode][value=${v.displayMode}]`).checked = true;
  document.getElementById('text').value = v.text;
  document.querySelector(`input[name=surface][value=${v.surface}]`).checked = true;
  document.getElementById('color').value = v.color;
  document.getElementById('texture').value = v.texture || '';
  document.getElementById('size').value = v.size;
  document.getElementById('speed').value = v.speed;
  document.getElementById('spin').value = v.spin;
  document.getElementById('font').value = v.font;
}
function encodeURL(v){
  const p = new URLSearchParams(v);
  // keep numbers compact
  p.set('size', String(v.size));
  p.set('speed', String(v.speed));
  const base = new URL('player.html', location.href);
  base.search = p.toString();
  return base.toString();
}
function loadSaved(){
  try{
    return Object.assign({}, DEF, JSON.parse(localStorage.getItem(KEY) || '{}'));
  }catch{ return DEF; }
}

const v0 = loadSaved();
writeUI(v0);
const $share = document.getElementById('share');
const $preview = document.getElementById('preview');

function refresh(){
  const v = readUI();
  const url = encodeURL(v);
  $share.value = url;
  $preview.src = url;
}
refresh();

document.querySelectorAll('.ui input, .ui select').forEach(el=>{
  el.addEventListener('input', refresh);
  el.addEventListener('change', refresh);
});
document.getElementById('previewBtn').onclick = refresh;
document.getElementById('copyBtn').onclick = async ()=>{
  await navigator.clipboard.writeText($share.value);
};
</script>
</body>
</html>
